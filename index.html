<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Refugive</title>
        <meta name="description" content="A refugee may need something. A local might have a spare item. Use this website to get in touch.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/bootstrap-responsive.min.css" type="text/css"/>
        <script src="/static/vendor/jquery.js"></script>
        <script type="text/html" id="about-template">
          <div class="intro">
            <div class="wrap">
              <h1>Refugive.com: a marketplace for refugees and neighbours</h1>
            </div>
          </div>
          <hr>
          <div class="main itempage">
            <div class="wrap">
              <section>
                <p>
                A new website for and by the neighbourhood: Refugive.com, a free marketplace for both refugees and neighbours. Our site wants to match the wishes of refugees to what neighbours are willing to share. Clothes for children and adults of course, but also books, games and social contacts. How about cooking a meal together, or doing sports?</p>
                <p>
                Are you in need of something - or: do you have clothes, things or time to spare? Have a look around on Refugive.com and meet your new neighbours! If you are a refugee, it is free to advertise your needs and wishes - but you can only reply to two offers made by locals at a time. Of course ads are free for locals as well, but offers should only be made within walking distance of the refugee center. And no money should trade hands.</p>
                <p>
                Refugive was started by a group of people in Bezuidenhout, The Hague wanting to help refugees in their neighbourhood. Refugive.com is a non profit website.</p>
                <p>
                Best regards,<br>Jasper, Jeroen, Krista, Maaike and Tijs</p>
              </section>
            </div>
          </div>
        </script>

        <script type="text/html" id="mysite-template">
            <button class="add">Add An Item</button>
            <% if (items !== null) { %>
              <div class="items">
                   <% _.each(items.models, function (item) { %>
                     <hr>
                     <div>
                         <div class="factwrap">
                           <a href="#item/<%- item.get('id') %>">
                             <h3 dir="ltr"><%=item.get('title')%></h3>
                           </a>
                           <% if (item.get('image') !== '') { %>
                             <div class="imgwrap">
                               <img src="https://res.cloudinary.com/dvrrqjzay/image/upload/c_fill,h_300,w_400/<%=item.get('image')%>.jpg">
                             </div>
                           <% } %>
                           <div class="factoids">
                             <div>
                               Category
                               <% _.each(categories.models, function (category) { %>
                                 <% if ('http://localhost:8000/api/categories/'+category.get('id') === item.get('category')) { %>
                                    <strong><%=category.get('name')%></strong>
                                 <% } %>
                               <% }); %>
                             </div>
                           </div>
                         </div>
                     </div>
                   <% }); %>
               </div>
            <% } else { %>
              <h3 class="loading">Loading...</h3>
            <% } %>
        </script>

        <script type="text/html" id="login-template">
            <form action="" method="post">
                <label for="id_email">E-mail:</label>
                <input id="id_email" type="text" name="email" pattern="^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$" required />
                <label for="id_password">Password:</label>
                <input id="id_password" type="password" name="password" required />
                <br>
                <button type="submit" class="btn btn-dafault">Submit</button>
                <a href="/nl/resetpassword/" class="reset">I lost my password</a>
            </form>
        </script>

        <script type="text/html" id="header-template">
              <% if (authenticated) { %>
                <ul class="nav nav-tabs">
                  <li role="presentation"><a href="#">Home</a>
                  <li role="presentation"><a href="#/settings">Settings</a>
                  <li role="presentation"><a href="#/help">Help</a>
                  <li role="presentation"><a href="#" class="logout">Logout</a>
                </ul>
              <% } else { %>
                <ul class="nav nav-tabs">
                  <li role="presentation"><a href="/">Home</a>
                  <li role="presentation"><a href="#">Login</a>
                  <li role="presentation"><a href="/adduser">Register</a>
                </ul>
              <% } %>
        </script>

        <script type="text/html" id="help-template">
                <h1>Q & A </h1>
                <hr>
                <strong><p>How can I add an item?</p></strong>
                <p>You can add an item by your page by clicking on add an item.</p>
                <strong><p>How can I change the content of an item?</p></strong>
                <p>You can change the content of an item by your page by clicking on the item.</p>
                <strong><p>How can I change my personal information?</p></strong>
                <p>You can change your information by click on settings.</p>
                <strong><p>How can I react on an item?</p></strong>
                <p>You can react on an item by clicking them.</p>
        </script>

        <script type="text/html" id="settings-template">
            <form action="/nl/adduser" method="post">
              <label for="id_email">E-mail:</label>
              <input id="id_email" type="text" name="email" value="<%=_.escape(user.get('email'))%>" required />
              <label for="id_username">Username:</label>
              <input id="id_username" type="text" name="username" value="<%=_.escape(user.get('username'))%>" required/>
              <% if (groups !== null) { %>
                <label for="id_group">Group: </label>
                <select id='id_group' name='group'>
                  <% _.each(groups.models, function(group){ %>
                    <% if(group.get('url') === user.get('group')){ %>
                      <option value="<%=_.escape(group.get('url'))%>" selected="true"><%=_.escape(group.get('name'))%></option>
                    <% } else { %>
                      <option value="<%=_.escape(group.get('url'))%>"><%=_.escape(group.get('name'))%></option>
                    <% } %>
                  <% }); %>
                </select>
              <% } %>
              <br>
              <button type="submit" class="btn btn-dafault">Save</button>
            </form>
        </script>

        <script type="text/html" id="new-item-template">
          <form action="/nl/image" method="post" enctype="multipart/form-data">
            <label for="id_title">Title:</label>
            <input name="csrfmiddlewaretoken" value="<%=csrf_token.get('csrf_token')%>" type="hidden">
            <input id="id_title" type="text" name="title" maxlength="100" required />
            <label for="id_description">Description:</label>
            <textarea id="id_description" name="description" cols="50"></textarea>
            <label for="id_image">Picture:</label>
            <input type="file" name="photo">
            <input type="hidden" id="id_owner" name="owner" value="<%=owner.get('id')%>">
            <% if (categories !== null) { %>
              <label for="id_description">Category: </label>
              <select id='id_category' name='category' required>
                <option value=""></option>
                <% _.each(categories.models, function(category){ %>
                  <option value="<%=category.get('id')%>"><%=_.escape(category.get('name'))%></option>
                <% }); %>
              </select>
            <% } %>
            <br>
            <button class="cancel btn btn-default">Cancel</button>
            <button type="submit" class="btn btn-default">Create</button>
          </form>
        </script>

        <script type="text/html" id="new-message-template">
          <form action="" method="post">
            <label for="id_text">Message:</label>
            <textarea id="id_text" name="text" cols="50"></textarea>
            <input type="hidden" name="owner" value="<%=user.get('url')%>">
            <input type="hidden" name="item" value="http://localhost:8000/api/items/<%=item.get('id')%>">
            <br>
            <button class="cancel btn btn-dafault">Cancel</button>
            <button type="submit" class="btn btn-dafault">Create</button>
          </form>
        </script>

        <script type="text/html" id="item-template">
          <div class="wrap">
            <section>
              <input type="hidden" name="id" value="<%=item.get('id')%>">
              <h1 dir="ltr"><%=item.get('title')%></h1>
              <div class="imgfactwrap">
                <div class="facts">
                  <p class="desc" dir="ltr">
                    <%=item.get('description')%>
                  </p>
                  <% if (users !== null) { %>
                    <p class="postedby">Offered by
                      <% _.each(users.models, function(user){ %>
                        <% if (user.get('url') === item.get('owner')) { %>
                          <strong><%=_.escape(user.get('username'))%></strong>
                        <% }; %>
                      <% }); %>
                      since <%=item.get('date')%>
                    </p>
                  <% } %>
                  <% _.each(messages.models, function (message) { %>
                      <%=message.get('full_text')%>
                      <br>
                  <% }); %>
                  <button class="add btn btn-dafault">Reply</button>
                </div>
              </div>
            </section>
          </div>
        </script>

        <script type="text/html" id="edit-template">
          <form action="" method="post">
            <button type="submit">Save</button>
            <button type="delete">Delete</button>
            <br/>
            <input type="hidden" name="id" value="<%=item.get('id')%>">
            <label for="id_title">Title:</label>
            <input id="id_title" type="text" name="title" maxlength="100" required value="<%=item.get('title')%>" />
            <label for="id_description">Description:</label>
            <textarea id="id_description" name="description" cols="50"><%=item.get('description')%></textarea>
            <label for="id_image">Picture:</label>
            <input type="file" id="id_image" name="image" accept="image/*">
            <% if (categories !== null) { %>
              <label for="id_description">Category: </label>
              <select id='id_category' name='category'>
                <% _.each(categories.models, function(category){ %>
                  <% if ('http://localhost:8000/api/categories/'+category.get('id') !== item.get('category')) { %>
                    <option value="<%=_.escape('http://localhost:8000/api/categories/'+category.get('id'))%>"><%=_.escape(category.get('name'))%></option>
                  <% } else { %>
                    <option value="<%=_.escape('http://localhost:8000/api/categories/'+category.get('id'))%>" selected><%=_.escape(category.get('name'))%></option>
                  <% }; %>
                <% }); %>
              </section>
            <% } %>
          </form>
        </script>
    </head>
    <body>
        <div class="container-fluid" id="content"></div>
        <script src="vendor/underscore.js"></script>
        <script src="vendor/backbone.js"></script>
        <script id="config" type="text/json">
            {
                "models": {},
                "collections": {},
                "views": {},
                "router": null,
                "apiRoot": "/api/",
                "apiLogin": "/api-token-auth/"
            }
        </script>
        <script src="app.js"></script>
        <script src="models.js"></script>
        <script src="views.js"></script>
        <script src="router.js"></script>
        <hr>
        <footer>
         <div class="wrap">
          <div class="opm">
            <p>What is Refugive and how does it work? <a href="#/about">About us</a></p>
            <div>
            	Tips, suggestions, complaints or questions? Please <a href="https://docs.google.com/forms/d/1i1wh3T_YJY1ts8wx7yeRCALiPjtDDbrabWn5tuvx1Xg/viewform">give us feedback</a>
            </div>
          </div>
        </div>
      </footer>
    </body>
</html>
